<!DOCTYPE html>
<html>
    <head>
        <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml"/>
        <link rel='stylesheet' href='./stylesheets/editor.css' />
        <link rel="stylesheet" href="./vender/jquery/zTreeStyle/zTreeStyle.css" type="text/css">  <!--仅设计模式需要引用-->
        <script src = "./vender/jquery/jquery.js"></script>
        <script src = "./vender/jquery/jquery.ztree.core.min.js"></script> <!--仅设计模式需要引用-->
        <script src = "./vender/jquery/jquery.ztree.exedit.min.js"></script><!--仅设计模式需要引用-->
        <script src = "./vender/jquery/jquery.ztree.exhide.min.js"></script><!--仅设计模式需要引用-->
        <script src="./js/editor.js"></script> 
        <script>
          $(function() {
            //配置项可以不设置，会使用默认设置
            let option = {
                license:'f1e462r9QMdQoYpeTI33ftw5xXE7pX1n1ecS5nA6ZUMZWrHurHpxhNkavsvDpvOJ/LsCdOLSw8/Zfay96JOl5AAIZNYozCYFMBGAUOFj3cjoU5kN7EMJIFqHKPFR6GXxSd+81XyvFF4maeHfKnl7PAJ8VkVoQiUFc1Fj3rSyz/w=',
                mode:'form',  //form:表单模式，design:设计模式
                dictionary: [  //知识库
                    {type:'symptoms', title: '体征', isParent:true, treeUrl:'https://www.x-emr.cn/dict', itemUrl:'https://www.x-emr.cn/dictitem'},
                    {type:'signs', title: '症状', isParent:true, treeUrl:'https://www.x-emr.cn/dict', itemUrl:'https://www.x-emr.cn/dictitem'},
                    {type:'meta', title: '卫生信息数据元', isParent:true, treeUrl:'https://www.x-emr.cn/dict', itemUrl:'https://www.x-emr.cn/dictitem'},
                    {type:'stand', title: '电子病历数据集', isParent:true, treeUrl:'https://www.x-emr.cn/dict', itemUrl:'https://www.x-emr.cn/dictitem'},
                    {type:'insutance', title: '国家医保标准', isParent:true, treeUrl:'https://www.x-emr.cn/insutance', itemUrl:'https://www.x-emr.cn/institem'},
                    {type:'province', title: 'A省数据平台标准', isParent:true, treeUrl:'https://www.x-emr.cn/province', itemUrl:'https://www.x-emr.cn/provitem'},
                ]
            }

            //用于父页面调用
            if(window.frameElement){
                //初始化前
                let e1 = new Event('before-init')
                e1.editor = editor
                e1.option = option
                window.frameElement.dispatchEvent(e1)
                //编辑器初始化
                editor.init(option)
                //指定文档ID加载病历文档
                let doc =  window.frameElement.getAttribute('doc')
                if(doc) {
                    editor.loadUrl(doc, '1').then(function(){
                        let e3 = new Event('doc-loaded')
                        e3.editor = editor
                        window.frameElement.dispatchEvent(e3)
                    })
                }
                
                //初始化后
                let e2 = new Event('after-init')
                e2.editor = editor
                window.frameElement.dispatchEvent(e2)
            }
          })
      </script>
    </head>
    <body>
        <!-- 默认id 为editor -->
        <div id="editor" style="width:100%; height:100%;"></div>
    </body>
</html>
